{"version":3,"sources":["../../src/parser/json.ts"],"names":["json","data","cfg","x","y","x1","y1","coordinates","resultData","Array","isArray","dataArray","forEach","col","featureIndex","coords","parseFloat","from","to","type","geometry","dataItem","_id","push","defaultData","lng1","lat1","lng2","lat2","defaultParser","parser"],"mappings":"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","sourcesContent":["// @ts-ignore\nimport {\n  IJsonData,\n  IJsonItem,\n  IParseDataItem,\n  IParserCfg,\n  IParserData,\n} from '@antv/l7-core';\n// @ts-ignore\nimport rewind from '@mapbox/geojson-rewind';\nexport default function json(data: IJsonData, cfg: IParserCfg): IParserData {\n  const { x, y, x1, y1, coordinates } = cfg;\n  const resultData: IParseDataItem[] = [];\n  if (!Array.isArray(data)) {\n    return {\n      dataArray: [],\n    };\n  }\n  data.forEach((col: IJsonItem, featureIndex: number) => {\n    let coords = [];\n    if (x && y) {\n      coords = [parseFloat(col[x]), parseFloat(col[y])];\n    } // 点数据\n    if (x && y && x1 && y1) {\n      const from = [parseFloat(col[x]), parseFloat(col[y])];\n      const to = [parseFloat(col[x1]), parseFloat(col[y1])];\n      coords = [from, to];\n    }\n    if (coordinates) {\n      let type = 'Polygon';\n      if (!Array.isArray(coordinates[0])) {\n        type = 'Point';\n      }\n      if (Array.isArray(coordinates[0]) && !Array.isArray(coordinates[0][0])) {\n        type = 'LineString';\n      }\n      const geometry = {\n        type,\n        coordinates: [...col[coordinates]],\n      };\n      rewind(geometry, true);\n      coords = geometry.coordinates;\n    }\n    const dataItem = {\n      ...col,\n      _id: featureIndex,\n      coordinates: coords,\n    };\n    resultData.push(dataItem);\n  });\n  return {\n    dataArray: resultData,\n  };\n}\n\n// TODO: 提供默认数据和解析器\nexport const defaultData = [\n  {\n    lng1: 100,\n    lat1: 30.0,\n    lng2: 130,\n    lat2: 30,\n  },\n];\n\nexport const defaultParser = {\n  parser: {\n    type: 'json',\n    x: 'lng1',\n    y: 'lat1',\n    x1: 'lng2',\n    y1: 'lat2',\n  },\n};\n"],"file":"json.js"}