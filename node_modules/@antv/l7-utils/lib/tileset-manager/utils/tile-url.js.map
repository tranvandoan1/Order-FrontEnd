{"version":3,"sources":["../../../src/tileset-manager/utils/tile-url.ts"],"names":["isURLTemplate","s","test","getURLFromTemplate","template","properties","length","Error","x","y","z","Array","isArray","index","Math","abs","replace","toString","pow"],"mappings":";;;;;;;;AAGO,SAASA,aAAT,CAAuBC,CAAvB,EAAkC;AACvC,SAAO,qCAAqCC,IAArC,CAA0CD,CAA1C,CAAP;AACD;;AAKM,SAASE,kBAAT,CACLC,QADK,EAELC,UAFK,EAGL;AACA,MAAI,CAACD,QAAD,IAAa,CAACA,QAAQ,CAACE,MAA3B,EAAmC;AACjC,UAAM,IAAIC,KAAJ,CAAU,gCAAV,CAAN;AACD;;AAED,MAAQC,CAAR,GAAoBH,UAApB,CAAQG,CAAR;AAAA,MAAWC,CAAX,GAAoBJ,UAApB,CAAWI,CAAX;AAAA,MAAcC,CAAd,GAAoBL,UAApB,CAAcK,CAAd;;AAEA,MAAIC,KAAK,CAACC,OAAN,CAAcR,QAAd,CAAJ,EAA6B;AAC3B,QAAMS,KAAK,GAAGC,IAAI,CAACC,GAAL,CAASP,CAAC,GAAGC,CAAb,IAAkBL,QAAQ,CAACE,MAAzC;AACAF,IAAAA,QAAQ,GAAGA,QAAQ,CAACS,KAAD,CAAnB;AACD;;AAED,SAAOT,QAAQ,CACZY,OADI,CACI,QADJ,EACcR,CAAC,CAACS,QAAF,EADd,EAEJD,OAFI,CAEI,QAFJ,EAEcP,CAAC,CAACQ,QAAF,EAFd,EAGJD,OAHI,CAGI,QAHJ,EAGcN,CAAC,CAACO,QAAF,EAHd,EAIJD,OAJI,CAII,SAJJ,EAIe,CAACF,IAAI,CAACI,GAAL,CAAS,CAAT,EAAYR,CAAZ,IAAiBD,CAAjB,GAAqB,CAAtB,EAAyBQ,QAAzB,EAJf,CAAP;AAKD","sourcesContent":["/*\n * 判断是否是一个合法的瓦片请求模版\n */\nexport function isURLTemplate(s: string) {\n  return /(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(s);\n}\n\n/*\n * 获取瓦片请求地址\n */\nexport function getURLFromTemplate(\n  template: string | string[],\n  properties: { x: number; y: number; z: number },\n) {\n  if (!template || !template.length) {\n    throw new Error('url is not allowed to be empty');\n  }\n\n  const { x, y, z } = properties;\n\n  if (Array.isArray(template)) {\n    const index = Math.abs(x + y) % template.length;\n    template = template[index];\n  }\n\n  return template\n    .replace(/\\{x\\}/g, x.toString())\n    .replace(/\\{y\\}/g, y.toString())\n    .replace(/\\{z\\}/g, z.toString())\n    .replace(/\\{-y\\}/g, (Math.pow(2, z) - y - 1).toString());\n}\n"],"file":"tile-url.js"}